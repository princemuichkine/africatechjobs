// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Job {
  id                String      @id @default(cuid())
  title             String
  description       String
  companyName       String
  companyId         String?
  location          String
  country           String
  type              JobType     @default(FULL_TIME)
  experienceLevel   ExperienceLevel @default(MID_LEVEL)
  salary            String?
  salaryMin         Int?
  salaryMax         Int?
  currency          String      @default("USD")
  remote            Boolean     @default(false)
  url               String
  source            String      // e.g., "LinkedIn", "Indeed", "Remote.co"
  sourceId          String?     // Unique ID from the source
  postedAt          DateTime
  deadline          DateTime?
  skills            String[]    // Array of required skills
  category          String      @default("Technology")
  tags              Tag[]
  company           Company?    @relation(fields: [companyId], references: [id])
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
  isActive          Boolean     @default(true)

  @@map("jobs")
}

model Company {
  id          String   @id @default(cuid())
  name        String   @unique
  description String?
  logo        String?
  website     String?
  industry    String?
  size        String?
  location    String?
  country     String?
  jobs        Job[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("companies")
}

model Tag {
  id    String @id @default(cuid())
  name  String @unique
  jobs  Job[]

  @@map("tags")
}

model ScrapeLog {
  id          String      @id @default(cuid())
  source      String
  status      ScrapeStatus @default(SUCCESS)
  jobsFound   Int         @default(0)
  jobsAdded   Int         @default(0)
  error       String?
  startedAt   DateTime    @default(now())
  completedAt DateTime?

  @@map("scrape_logs")
}

enum JobType {
  FULL_TIME
  PART_TIME
  CONTRACT
  FREELANCE
  INTERNSHIP
  APPRENTICESHIP
}

enum ExperienceLevel {
  ENTRY_LEVEL
  JUNIOR
  MID_LEVEL
  SENIOR
  LEAD
  EXECUTIVE
}

enum ScrapeStatus {
  SUCCESS
  PARTIAL_SUCCESS
  FAILED
}
